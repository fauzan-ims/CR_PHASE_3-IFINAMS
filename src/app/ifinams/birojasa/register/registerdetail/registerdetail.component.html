<div class="main-content">
    <!-- spinner region -->
    <div class="panel-container-spinner" *ngIf="showSpinner">
        <app-spinner class="spinner-container"></app-spinner>
    </div>
    <!-- end spinner region -->
    <div class="row">
        <div class="col-md-12">
            <div class="card ">
                <!--#region watermark-->
                <div class="watermark" [hidden]="this.isWatermark === '0'">
                    <h6>{{this.companyName}}</h6>
                    <h6>{{this.userName}}</h6>
                    <h6>{{this.sysDate | date}} {{this.currentTime}}</h6>
                </div>
                <!--#endregion watermark-->
                <!-- <div class="card"> -->
                <div class="card-body ">
                    <div class="card-header ">
                        <h5 class="card-title">Register Info</h5>
                    </div>
                    <!--#region registerDetail form-->
                    <form #registerForm="ngForm" (ngSubmit)="onFormSubmit(registerForm.value, registerForm.valid)">

                        <!--#region registerDetail button submit dan back-->
                        <button type="submit" class="btn btn-info btn-round" [hidden]="model.register_status != 'HOLD' && model.register_status != 'RETURN'"
                            data-role="R00022320012232C">Save</button>
                        <button type="button" class="btn btn-success btn-round" data-role="R00022320002233O"
                            [hidden]="model.register_status !== 'HOLD' && model.register_status != 'RETURN' || param == null"
                            (click)="btnProceed()">Proceed</button>
                        <button [hidden]="model.register_status !== 'ON PROCESS' || param == null" type="button"
                            data-role="R00022320042233R" class="btn btn-warning btn-round"
                            (click)="btnReturn()">Return</button>
                        <button type="button" class="btn btn-warning btn-round" data-role="R00022320002233R"
                            [hidden]="model.register_status !== 'HOLD' && model.register_status != 'RETURN' || param == null"
                            (click)="btnCancel()">Cancel</button>
                        <button type="button" class="btn btn-danger btn-round" (click)="btnBack()">Back</button>
                        <!--#publicservice detail button submit dan back-->

                        <!--#region publicservice detail row-->
                        <div class="row">
                            <!--#region publicservice register_no-->
                            <div class="col-md-4">
                                <div [hidden]="model.code != null" class="row"
                                    style="margin-bottom: -15px; padding-top: 30px;">
                                    <h1 class="col-md-4" style="font-size: 12px;">Register No</h1>
                                    <h1 class="col-md-8" style="font-size: 12px;">-Auto
                                        Generate-</h1>
                                </div>
                                <div [hidden]="model.code == null" class="form-group">
                                    <label>Register No</label>
                                    <input type="text" class="form-control" [ngModel]="model.register_no" maxlength="50"
                                        name="p_register_no" [readonly]="isReadOnly">
                                    <input type="hidden" class="form-control" [ngModel]="model.code" name="p_code"
                                        [readonly]="isReadOnly">
                                </div>
                            </div>
                            <!--#endregion publicservice register_no-->

                            <!--#region publicserviceAddresDetail Branch Code-->
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="control-label labelmodule">Branch *</label>
                                    <div class="col-md-12 buttons btn-lookup-margin">
                                        <span>
                                            <button class="btn btn-icon btn-outline-default btn-round btn-md"
                                                type="button" [disabled]="isReadOnly" (click)="btnLookupBranch()"
                                                data-toggle="modal" data-target="#lookupModalBranch" href="#"><i
                                                    class="fa fa-search-plus"></i></button>
                                            {{model.branch_name}}
                                            <input type="hidden" class="form-control" [ngModel]="model.branch_code"
                                                name="p_branch_code">
                                            <input type="hidden" class="form-control" [ngModel]="model.branch_name"
                                                name="p_branch_name" required #branch_name="ngModel">
                                        </span>
                                    </div>
                                    <small
                                        [hidden]="branch_name.valid || (branch_name.pristine && !registerForm.submitted)"
                                        class="text-danger">
                                        Branch is required
                                    </small>
                                </div>
                            </div>
                            <!--#endregion publicserviceAddresDetail Branch Code-->

                            <!--#region Register Status -->
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Status</label>
                                    <input type="text" class="form-control" readonly maxlength="20"
                                        [ngModel]="model.register_status" name="p_register_status">
                                </div>
                            </div>
                            <!--#endregion  Register Status-->

                            <!--#region Register date-->
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="register_date" class="control-label">Date *</label>
                                    <div>
                                        <input [ngStyle]="getStyles(isStatus)" class="form-control col-md-6"
                                            placeholder="dd/mm/yyyy" angular-mydatepicker
                                            [ngModel]="model.register_date" name="p_register_date"
                                            [options]="myDatePickerOptions" required #p_register_date="ngModel"
                                            #register_date="angular-mydatepicker" autocomplete="off"
                                            (click)="register_date.toggleCalendar()" [readonly]="isStatus" />
                                        <small
                                            *ngIf="(p_register_date.errors?.required && p_register_date.touched) || (p_register_date.errors?.required && registerForm.submitted)"
                                            class="text-danger">
                                            Date is required
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <!--#endregion Register date-->

                            <!--#region FA Code -->
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>FA Code *</label>
                                    <div class="col-md-12 buttons btn-lookup-margin">
                                        <span>
                                            <button class="btn btn-icon btn-outline-default btn-round btn-md"
                                                type="button" (click)="btnLookupFACode()" data-toggle="modal"
                                                [disabled]="model.register_status != 'HOLD' && model.register_status !== 'RETURN'"
                                                data-target="#lookupModalFACode" href="#"><i
                                                    class="fa fa-search-plus"></i></button>
                                            {{model.item_name}} - {{model.plat_no}}
                                            <input type="hidden" class="form-control" [ngModel]="model.fa_code"
                                                name="p_fa_code" required #fa_code="ngModel">
                                        </span>
                                    </div>
                                    <small [hidden]="fa_code.valid || (fa_code.pristine && !registerForm.submitted)"
                                        class="text-danger">
                                        Agreement No is required
                                    </small>
                                </div>
                            </div>
                            <!--#endregion FA Code-->

                            <!--#region Register Procces By-->
                            <div class="col-md-4" hidden>
                                <label>Processed By *</label>
                                <div class="form-group col-md-12">
                                    <div class="row">
                                        <div class="form-check-radio form-check-inline">
                                            <label class="form-check-label">
                                                <input class="form-check-input"
                                                    [disabled]="model.register_status != 'HOLD' && model.register_status !== 'RETURN'" type="radio"
                                                    name="p_register_process_by" value="INTERNAL"
                                                    [(ngModel)]="model.register_process_by"
                                                    #register_process_by="ngModel"
                                                    (change)="PageStatus($event)">Internal
                                                <span class="form-check-sign"></span>
                                            </label>
                                        </div>
                                        <div class="form-check-radio form-check-inline">
                                            <label class="form-check-label">
                                                <input class="form-check-input" type="radio"
                                                    name="p_register_process_by" value="CUSTOMER"
                                                    [(ngModel)]="model.register_process_by"
                                                    #register_process_by="ngModel"
                                                    (change)="PageStatus($event)">Customer
                                                <span class="form-check-sign"></span>
                                            </label>
                                        </div>
                                        <small
                                            *ngIf="(register_process_by.errors?.required && register_process_by.touched) || (register_process_by.errors?.required && registerForm.submitted)"
                                            class="text-danger">
                                            Processed By is required
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <!--#endregion  Register Procces By-->

                            <!--#region is_reimburse-->
                            <div class="col-md-4">
                                <div class="form-check mt-4" style="margin-left: -35px;">
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input [disabled]="model.register_status != 'HOLD' && model.register_status !== 'RETURN'" class="form-check-input"
                                                type="checkbox" [(ngModel)]="model.is_reimburse" name="p_is_reimburse">
                                            Disburse To Customer
                                            <span class="form-check-sign"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!--#endregion is_reimburse-->

                            <!--#region is_reimburse_to_customer-->
                            <div class="col-md-4">
                                <div class="form-check mt-4" style="margin-left: -35px;">
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input [disabled]="model.register_status != 'HOLD' && model.register_status !== 'RETURN'" class="form-check-input"
                                                type="checkbox" [(ngModel)]="model.is_reimburse_to_customer"
                                                name="p_is_reimburse_to_customer">
                                            Reimburse To Customer
                                            <span class="form-check-sign"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!--#endregion is_reimburse_to_customer-->

                            <!--#region Dp From Customer  -->
                            <!-- <div class="col-md-4">
                                <div class="form-group"
                                    [class.has-error]="dp_from_customer_amount.invalid && dp_from_customer_amount.touched">
                                    <label for="dp_from_customer_amount" class="control-label"
                                        [hidden]="model.register_process_by !== 'INTERNAL'">DP By Client Amount
                                        *</label>
                                    <label for="dp_from_customer_amount" class="control-label"
                                        [hidden]="model.register_process_by !== 'CUSTOMER'">Admin Fee *</label>
                                    <input type="text" class="form-control text-right col-md-6"
                                        [ngModel]="model.dp_from_customer_amount | number : '1.2-2'"
                                        name="p_dp_from_customer_amount" required #dp_from_customer_amount="ngModel"
                                        maxlength="24" amount="dp_from_customer_amount"
                                        [readonly]="model.register_status != 'HOLD'">
                                </div>
                                <small
                                    *ngIf="(dp_from_customer_amount.errors?.required && dp_from_customer_amount.touched && model.register_process_by !== 'CUSTOMER') || (dp_from_customer_amount.errors?.required && registerForm.submitted)"
                                    class="text-danger">
                                    DP By Client Amount is required
                                </small>
                                <small
                                    *ngIf="(dp_from_customer_amount.errors?.required && dp_from_customer_amount.touched && model.register_process_by !== 'INTERNAL') || (dp_from_customer_amount.errors?.required && registerForm.submitted)"
                                    class="text-danger">
                                    Admin Fee is required
                                </small>
                            </div> -->
                            <!--#endregion Dp From Customer  -->

                            <!--#region Register Remarks-->
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="register_remarks" class="control-label">Remark *</label>
                                    <textarea type="text" [readonly]="model.register_status != 'HOLD' && model.register_status !== 'RETURN'"
                                        class="form-control" [ngModel]="model.register_remarks"
                                        name="p_register_remarks" required #register_remarks="ngModel"></textarea>
                                    <small
                                        *ngIf="(register_remarks.errors?.required && register_remarks.touched) || (register_remarks.errors?.required && registerForm.submitted)"
                                        class="text-danger">
                                        Remark is required
                                    </small>
                                </div>
                            </div>
                            <!--#endregion  Register Remarks-->
                        </div>
                        <!--#endregion publicservice detail row-->
                    </form>
                    <!--#endregion publicservice detail form-->
                </div>
                <!--#region wizard-->
                <div class="wizard-custom-margin" [hidden]="param == null">
                    <!--#region wizard container -->
                    <div class="wizard-container">
                        <div class="card-wizard" style="opacity: 1 !important; min-height: 0px;" data-color="primary"
                            id="wizardProfile">
                            <div class="text-center">
                                <div class="wizard-navigation">
                                    <ul>
                                        <li class="nav-item">
                                            <a class="nav-link" (click)="registerdetailwiz()" href="#registerdetaillist"
                                                data-toggle="tab" role="tab" aria-controls="registerdetaillist"
                                                aria-selected="true">
                                                Service
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" (click)="registerdocumentwiz()"
                                                href="#registerdocumentlist" data-toggle="tab" role="tab"
                                                aria-controls="registerdocumentlist" aria-selected="true">
                                                Document
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--endregion wizard-->
                <router-outlet (activate)="onRouterOutletActivate($event)"></router-outlet>
            </div>
        </div>
    </div>
</div>

<!--#region lookup Branch-->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalBranch"
    style="margin-top: -65px">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body" style="overflow:hidden;">
                <div class="col-md-12">
                    <div class="card-body col-md-12">

                        <table id="datatableLookupBranch" class="table table-striped table-bordered hover"
                            cellspacing="0" style="min-width: 100%;">
                            <thead>
                                <tr>
                                    <th class="disabled-sorting">No</th>
                                    <th>Code</th>
                                    <th>Branch Name</th>
                                    <th style="text-align: center; width: 5%;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of lookupbranch; let i=index">
                                    <td style="text-align: center;">{{lookupbranch.numberIndex+i+1}}</td>
                                    <td style="text-align: center; width: 25%;">{{ row.code }}</td>
                                    <td style="text-align: left; width: 75%;">{{ row.name }}</td>
                                    <td class="text-center">
                                        <button class="btn btn-outline-default btn-round"
                                            (click)="btnSelectRowBranch(row.code, row.name)">Select</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--#endregion lookup Branch-->

<!--#region lookup FA Code -->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalFACode"
    style="margin-top: -65px">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body" style="overflow:hidden;">
                <div class="col-md-12 buttons btn-lookup-margin">
                    <div class="card-body col-md-12">
                        <table id="datatableLookupFACode" class="table table-striped table-bordered hover"
                            cellspacing="0" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th class="disabled-sorting">No</th>
                                    <th>Code</th>
                                    <th>Plat No</th>
                                    <th>Description</th>
                                    <th style="text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of lookupfacode; let i=index">
                                    <td style="text-align: center;">{{lookupfacode.numberIndex+i+1}}</td>
                                    <td style="text-align: center; width: 20%;">{{ row.code }}</td>
                                    <td style="text-align: left; width: 15%;">{{ row.plat_no }}</td>
                                    <td style="text-align: left; width: 65%;">{{ row.item_name}}</td>
                                    <td class="text-center">
                                        <button class="btn btn-outline-default btn-round"
                                            (click)="btnSelectRowFACode(row.code, row.item_name, row.plat_no)">Select</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--#endregion lookup FA Code -->