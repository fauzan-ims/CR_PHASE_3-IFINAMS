<div class="main-content margin-wizard-content">
    <!-- spinner region -->
    <div class="panel-container-spinner" *ngIf="showSpinner">
        <app-spinner class="spinner-container"></app-spinner>
    </div>
    <!-- end spinner region -->
    <div class="row">
        <div class="col-md-12">
            <div class="card-body ">
                <!--#region form-->
                <form #publicserviceaddressForm="ngForm"
                    (ngSubmit)="onFormSubmit(publicserviceaddressForm.value, publicserviceaddressForm.valid)">

                    <!--#region button submit dan back-->
                    <button hidden type="submit" ng-disabled="publicserviceaddressForm.$invalid"
                        class="btn btn-info btn-round" data-role="R00021430032143C">Save</button>
                    <button hidden id="reloadHeader" type="button" class="btn btn-danger btn-round"
                        (click)="this.callGetrow()">Back</button>
                    <button type="button" class="btn btn-danger btn-round" (click)="btnBack()">Back</button>
                    <!--#endregion publicserviceAddresDetail button submit dan back-->
                    <!--#region button--->
                    <!-- <button id="reloadWiz" hidden class="btn btn-danger btn-round"
                    (click)="callGetrowHeader()"></button> -->
                    <!--#endregion button---
                    <!--#region row-->
                    <div class="row">
                        <!--#region id-->
                        <input hidden type="text" [ngModel]="model.code" name="p_code">
                        <!--#endregion id-->

                        <!--#region publicserviceBankDetail publicservice Code-->
                        <input type="text" [ngModel]="model.policy_code" name="p_policy_code" hidden>
                        <!--#endregion publicserviceBankDetail publicservice Code-->

                        <!--#region code-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Code</label>
                                <input type="text" class="form-control" [ngModel]="model.code" name="p_code" readonly>
                            </div>
                        </div>
                        <!--#endregion code-->

                        <!--#region status_asset-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Status Policy Asset</label>
                                <input type="text" class="form-control" [ngModel]="model.status_asset"
                                    name="p_status_asset" readonly>
                            </div>
                        </div>
                        <!--#endregion status_asset-->

                        <!--#region fa_code-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Fixed Asset</label>
                                <input type="text" class="form-control" [ngModel]="model.fa_code" name="p_fa_code"
                                    readonly>
                            </div>
                        </div>
                        <!--#endregion fa_code-->

                        <!--#region item_name-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Fixed Asset Name</label>
                                <input type="text" class="form-control" [ngModel]="model.item_name" name="p_item_name"
                                    readonly>
                            </div>
                        </div>
                        <!--#endregion item_name-->

                        <!--#region depreciation_name-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Depreciation</label>
                                <input type="text" class="form-control" [ngModel]="model.depreciation_name"
                                    name="p_depreciation_name" readonly>
                            </div>
                        </div>
                        <!--#endregion depreciation_name-->

                        <!--#region occupation_name-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Occupation</label>
                                <input type="text" class="form-control" [ngModel]="model.occupation_name"
                                    name="p_occupation_name" readonly>
                            </div>
                        </div>
                        <!--#endregion occupation_name-->

                        <!--#region region_name-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Region</label>
                                <input type="text" class="form-control" [ngModel]="model.region_name"
                                    name="p_region_name" readonly>
                            </div>
                        </div>
                        <!--#endregion region_name-->

                        <!--#region sum_insured_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Sum Insured Amount</label>
                                <input type="text" style="text-align: right;" class="form-control col-md-6"
                                    maxlength="24" amount="sum_insured_amount"
                                    [ngModel]="model.sum_insured_amount | number : '1.2-2'" name="p_sum_insured_amount"
                                    readonly>
                            </div>
                        </div>
                        <!--#endregion sum_insured_amount-->

                        <!--#region collateral_type-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Collateral Type</label>
                                <input type="text" class="form-control" [ngModel]="model.collateral_type"
                                    name="p_collateral_type" readonly>
                            </div>
                        </div>
                        <!--#endregion collateral_type-->

                        <!--#region collateral_year-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Collateral Year</label>
                                <input type="text" class="form-control" [ngModel]="model.collateral_year"
                                    name="p_collateral_year" readonly>
                            </div>
                        </div>
                        <!--#endregion collateral_year-->

                        <!--#region total_premi_amount-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Total Coverage Premi Amount</label>
                                <input type="text" style="text-align: right;" class="form-control col-md-6"
                                    maxlength="24" amount="total_premi_amount"
                                    [ngModel]="model.total_premi_amount | number : '1.2-2'" name="p_total_premi_amount"
                                    readonly>
                            </div>
                        </div>
                        <!--#endregion total_premi_amount-->

                        <!--#region accessories-->
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="accessories" class="control-label">Accessories</label>
                                <textarea readonly type="text" class="form-control" [ngModel]="model.accessories"
                                    name="p_accessories" #accessories="ngModel"></textarea>
                            </div>
                        </div>
                        <!--#endregion accessories-->

                        <!--#region is_authorized_workshop-->
                        <div class="col-md-4">
                            <div class="form-check mt-3" style="margin-left: -35px;">
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input class="form-check-input" type="checkbox"
                                            [ngModel]="model.is_authorized_workshop" name="p_is_authorized_workshop"
                                            disabled>
                                        Autorized Workshop
                                        <span class="form-check-sign"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <!--#endregion is_authorized_workshop-->

                        <!--#region is_commercial-->
                        <div class="col-md-4">
                            <div class="form-check mt-3" style="margin-left: -35px;">
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input class="form-check-input" type="checkbox" [ngModel]="model.is_commercial"
                                            name="p_is_commercial" disabled>
                                        Commercial
                                        <span class="form-check-sign"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <!--#endregion is_commercial-->
                    </div>
                    <!--#endregion row-->
                </form>
                <!--#endregion form-->
            </div>
            <span layout="row horizontal-divider">
                <hr flex />
            </span>
            <div *ngIf="params != null" class="row">
                <div class="col-md-12">
                    <div class="card-header">
                        <h5 class="card-title">Asset Coverage List</h5>
                    </div>
                    <div class="card-body">
                        <div class="toolbar">
                            <!--#region button add--->
                            <button
                                [hidden]="model.policy_payment_status !== 'HOLD' || model.status_asset == 'ACTIVE' || model.status_asset =='TERMINATE'"
                                class="btn btn-info btn-round" (click)="btnSaveList()" data-role="R00022090022213C">
                                Save
                            </button>
                            <button hidden id="tabdetailwiz" type="button" (click)="callGetrowHeader()"></button>
                            <!--#endregion button add--->
                        </div>
                        <!--#region list view-->
                        <table id="datatablespolicyassetcoverage" datatable [dtOptions]="dtOptions"
                            class="table table-striped table-bordered row-border hover" cellspacing="0" width="100%">
                            <thead>
                                <tr>
                                    <th style="display: none;"></th>
                                    <th class="disabled-sorting">No</th>
                                    <th>Period (Year)</th>
                                    <th>Coverage</th>
                                    <th>Rate Depreciation</th>
                                    <th>Buy Amount</th>
                                    <th>Discount</th>
                                    <th>Tax / PPN Amount / PPH Amount</th>
                                    <th>Admin Fee</th>
                                    <th>Stamp Fee</th>
                                    <th>Coverage Premi Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of listpolicyassetcoverage;  let i=index">
                                    <td style="text-align: center;">{{listpolicyassetcoverage.numberIndex+i+1}}</td>
                                    <td style="display: none;"></td>
                                    <input type="hidden" value="{{row.id}}" name="p_id_detail">
                                    <td class="if-no-edit-btn" style="width: 10%;text-align: center;">
                                        {{row.year_periode}}</td>
                                    <td style="width: 10%;text-align: left;">{{row.coverage_name}}</td>
                                    <td style="width: 10%;text-align: right;">{{row.rate_depreciation | number :
                                        '1.6-6'}}</td>
                                    <td style="text-align: right; width: 15%;">
                                        <div class="form-group">
                                            <input id="initial_buy_amount{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_buy_amount')"
                                                (focus)="onFocus($event,i,'amount','initial_buy_amount')"
                                                class="text-right" type="text"
                                                value="{{row.initial_buy_amount | number : '1.2-2'}}"
                                                amount="initial_buy_amount" name="p_initial_buy_amount"
                                                [disabled]="model.policy_payment_status !== 'HOLD' || row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div>
                                    </td>
                                    <!-- <td style="width: 10%;text-align: right;">{{row.initial_discount_amount |
                                        number : '1.2-2'}}
                                    </td> -->
                                    <td style="text-align: right; width: 10%;">
                                        <div class="form-group">
                                            <input id="initial_discount_amount{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_discount_amount')"
                                                (focus)="onFocus($event,i,'amount','initial_discount_amount')"
                                                class="text-right" type="text"
                                                value="{{row.initial_discount_amount | number : '1.2-2'}}"
                                                amount="initial_discount_amount" name="p_initial_discount_amount"
                                                [disabled]="model.policy_payment_status !== 'HOLD' ||row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div>
                                        <!-- <div class="form-group">
                                            <input id="initial_discount_ppn{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_discount_ppn')"
                                                (focus)="onFocus($event,i,'amount','initial_discount_ppn')"
                                                class="text-right" type="text"
                                                value="{{row.initial_discount_ppn | number : '1.2-2'}}"
                                                amount="initial_discount_ppn" name="p_initial_discount_ppn"
                                                [disabled]="model.policy_payment_status != 'HOLD' || row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div><br> -->
                                    </td>
                                    <td> <!--(+) Ari 2024-01-08 Ket : add ppn editable with tax-->
                                        <div class="form-group">
                                            <div class="col-md-12 buttons">
                                                <span>
                                                    <button class="btn btn-icon btn-outline-default btn-round btn-md"
                                                        type="button" (click)="btnLookupTaxCode(row.id)"
                                                        data-target="#lookupModalTax" data-toggle="modal" href="#"
                                                        [disabled]="model.policy_payment_status != 'HOLD'">
                                                        <i class="fa fa-search-plus"></i>
                                                    </button> {{row.master_tax_description}}
                                                    <input hidden name="p_tax_code" value="{{row.master_tax_code}}" />
                                                    <input hidden name="p_tax_name"
                                                        value="{{row.master_tax_description}}" />
                                                </span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <input id="initial_discount_ppn{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_discount_ppn')"
                                                (focus)="onFocus($event,i,'amount','initial_discount_ppn')"
                                                class="text-right" type="text"
                                                value="{{row.initial_discount_ppn | number : '1.2-2'}}"
                                                amount="initial_discount_ppn" name="p_initial_discount_ppn"
                                                [disabled]="model.policy_payment_status !== 'HOLD' || row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div>
                                        <div class="form-group">
                                            <input id="initial_discount_pph{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_discount_pph')"
                                                (focus)="onFocus($event,i,'amount','initial_discount_pph')"
                                                class="text-right" type="text"
                                                value="{{row.initial_discount_pph | number : '1.2-2'}}"
                                                amount="initial_discount_pph" name="p_initial_discount_pph"
                                                [disabled]="model.policy_payment_status !== 'HOLD' || row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div>
                                    </td> <!--(+) Ari 2024-01-08 -->
                                    <!-- <td style="width: 10%;text-align: right;">{{row.initial_admin_fee_amount |
                                        number : '1.2-2'}}
                                    </td> -->
                                    <td style="text-align: right; width: 10%;">
                                        <div class="form-group">
                                            <input id="initial_admin_fee_amount{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_admin_fee_amount')"
                                                (focus)="onFocus($event,i,'amount','initial_admin_fee_amount')"
                                                class="text-right" type="text"
                                                value="{{row.initial_admin_fee_amount | number : '1.2-2'}}"
                                                amount="initial_admin_fee_amount" name="p_initial_admin_fee_amount"
                                                [disabled]="model.policy_payment_status !== 'HOLD' || row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div>
                                    </td>
                                    <!-- <td style="width: 10%;text-align: right;">{{row.initial_stamp_fee_amount |
                                        number : '1.2-2'}}
                                    </td> -->
                                    <td style="text-align: right; width: 15%;">
                                        <div class="form-group">
                                            <input id="initial_stamp_fee_amount{{i}}"
                                                (blur)="onBlur($event,i,'amount','initial_stamp_fee_amount')"
                                                (focus)="onFocus($event,i,'amount','initial_stamp_fee_amount')"
                                                class="text-right" type="text"
                                                value="{{row.initial_stamp_fee_amount | number : '1.2-2'}}"
                                                amount="initial_stamp_fee_amount" name="p_initial_stamp_fee_amount"
                                                disabled>
                                        </div>
                                    </td>
                                    <td style="width: 15%;text-align: right;">{{row.buy_amount |
                                        number : '1.2-2'}}
                                    </td>
                                    <!-- <td style="text-align: right; width: 15%;">
                                        <div class="form-group">
                                            <input id="buy_amount{{i}}" (blur)="onBlur($event,i,'amount','buy_amount')"
                                                (focus)="onFocus($event,i,'amount','buy_amount')" class="text-right"
                                                type="text" value="{{row.buy_amount | number : '1.2-2'}}"
                                                amount="buy_amount" name="p_buy_amount"
                                                [disabled]="row.status_asset == 'ACTIVE' || row.status_asset =='TERMINATE'">
                                        </div>
                                    </td> -->
                                </tr>
                            </tbody>
                        </table>
                        <!--#endregion list view-->
                    </div>
                </div>
            </div>
            <!--#endregion list view-->
        </div>
    </div>
</div>


<!--#region lookup Tax-->
<div class="modal bd-example-modal-lg" tabindex="-1" aria-hidden="true" id="lookupModalTax" style="margin-top: -65px">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body" style="overflow:hidden;">
                <div class="col-md-12">
                    <div class="card-body col-md-12">
                        <table id="datatableLookupTax" class="table table-striped table-bordered hover" cellspacing="0"
                            style="width: 100%;">
                            <thead>
                                <tr>
                                    <th style="display: none;"></th>
                                    <th class="disabled-sorting">No</th>
                                    <th>Code</th>
                                    <th>Description</th>
                                    <th style="text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of lookupTax;let i=index ">
                                    <td class="if-no-edit-btn" style="display: none;"></td>
                                    <td style="text-align: center;">{{lookupTax.numberIndex+i+1}}</td>
                                    <td style="width: 20%;text-align: center;">{{ row.code }}</td>
                                    <td style="width: 80%;">{{ row.name }}</td>
                                    <td class="text-center">
                                        <button class="btn btn-outline-default btn-round"
                                            (click)="btnSelectRowTax(row.code, row.name, row.ppn_pct, row.pph_pct)">Select</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--#endregion lookup Tax -->